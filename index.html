<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="ìš”ì •êµì‹¤">
  <meta name="theme-color" content="#FFB6C1">
  <meta name="description" content="ìš”ì •êµì‹¤ - í•œê¸€, ìˆ«ì, ì˜ì–´ë¥¼ ì¬ë¯¸ìˆê²Œ ë°°ìš°ëŠ” ìœ ì•„ í•™ìŠµ ì•±">

  <title>ìš”ì •êµì‹¤ - ìœ ì•„ í•™ìŠµ ì•±</title>

  <link rel="manifest" href="manifest.json">
  <link rel="icon" type="image/svg+xml" href="assets/icons/favicon.svg">
  <link rel="apple-touch-icon" href="assets/icons/icon-192.png">

  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header id="app-header" class="app-header" style="display:none"></header>

  <div id="screen-splash" class="screen active"></div>
  <div id="screen-profile" class="screen"></div>
  <div id="screen-home" class="screen"></div>
  <div id="screen-category" class="screen"></div>
  <div id="screen-learn" class="screen"></div>
  <div id="screen-game-select" class="screen"></div>
  <div id="screen-game" class="screen"></div>
  <div id="screen-combine" class="screen"></div>
  <div id="screen-coloring" class="screen"></div>
  <div id="screen-reward" class="screen"></div>
  <div id="screen-attendance" class="screen"></div>
  <div id="screen-parent" class="screen"></div>
  <div id="screen-benchmark" class="screen"></div>
  <div id="screen-reference" class="screen"></div>

  <nav id="tab-bar" class="tab-bar" style="display:none">
    <button class="tab-btn active" data-tab="home" onclick="App.tabHome()">
      <span class="tab-icon">ğŸ </span><span class="tab-label">í™ˆ</span>
    </button>
    <button class="tab-btn" data-tab="hangul" onclick="App.tabHangul()">
      <span class="tab-icon">ğŸ”¤</span><span class="tab-label">í•œê¸€</span>
    </button>
    <button class="tab-btn" data-tab="english" onclick="App.tabEnglish()">
      <span class="tab-icon">ğŸ”¡</span><span class="tab-label">ì˜ì–´</span>
    </button>
    <button class="tab-btn" data-tab="number" onclick="App.tabNumber()">
      <span class="tab-icon">ğŸ”¢</span><span class="tab-label">ìˆ«ì</span>
    </button>
    <button class="tab-btn" data-tab="play" onclick="App.tabPlay()">
      <span class="tab-icon">ğŸ®</span><span class="tab-label">ë†€ì´</span>
    </button>
    <button class="tab-btn" data-tab="reward" onclick="App.tabReward()">
      <span class="tab-icon">ğŸ</span><span class="tab-label">ë³´ìƒí•¨</span>
    </button>
  </nav>

  <script defer src="js/design-pack.js"></script>
  <script defer src="js/generated-kids-designs.js"></script>
  <script defer src="js/data.js"></script>
  <script defer src="js/storage.js"></script>
  <script defer src="js/speech.js"></script>
  <script defer src="js/profile.js"></script>
  <script defer src="js/reward.js"></script>
  <script defer src="js/daily.js"></script>
  <script defer src="js/learn.js"></script>
  <script defer src="js/game.js"></script>
  <script defer src="js/iq-lab.js"></script>
  <script defer src="js/github-pack-games.js"></script>
  <script defer src="js/coloring.js"></script>
  <script defer src="js/benchmark.js"></script>
  <script defer src="reference_import/dump_manifest.js"></script>
  <script defer src="js/dump.js"></script>
  <script defer src="js/ads.js"></script>
  <script defer src="js/app.js"></script>

  <script>
    (function () {
      const APP_VERSION = '2026-03-01-iq-hotfix-4';
      const SW_VERSION = 'v22';
      const VERSION_KEY = 'fairy-classroom-app-version';

      async function hardRefreshOncePerVersion() {
        try {
          const saved = localStorage.getItem(VERSION_KEY);
          if (saved === APP_VERSION) return;
          localStorage.setItem(VERSION_KEY, APP_VERSION);

          if ('caches' in window) {
            const keys = await caches.keys();
            await Promise.all(keys.map((k) => caches.delete(k)));
          }
          if ('serviceWorker' in navigator) {
            const regs = await navigator.serviceWorker.getRegistrations();
            await Promise.all(regs.map((reg) => reg.unregister()));
          }
          location.reload();
        } catch (_) {}
      }

      async function setupServiceWorker() {
        if (!('serviceWorker' in navigator)) return;
        try {
          const reg = await navigator.serviceWorker.register(`service-worker.js?${SW_VERSION}`, {
            updateViaCache: 'none',
          });
          setInterval(() => reg.update(), 30000);
          reg.addEventListener('updatefound', () => {
            const next = reg.installing;
            if (!next) return;
            next.addEventListener('statechange', () => {
              if (next.state === 'activated') location.reload();
            });
          });
        } catch (_) {}
      }

      window.addEventListener('load', async () => {
        await hardRefreshOncePerVersion();
        await setupServiceWorker();
      });
    })();
  </script>
</body>
</html>
